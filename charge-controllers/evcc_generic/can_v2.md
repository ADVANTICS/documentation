<!--
../../../../Manuals/databases/db/Advantics_Generic_PEV_protocol_v1.kcd CAN Database documentation file
Automatically generated by KCDDOC
Copyright ADVANTICS 2017
-->

# CAN messages

## Message index


<div class="compact-table">

| Name | ID | Length | Direction | Cycle time |
|------|----|--------|-----------|------------|
| [EVSE_Information](#EVSE_Information) | 0x600 | 6 | OUT | 100 |
| [AC_Control](#AC_Control) | 0x601 | 1 | OUT | 100 |
| [DC_Control](#DC_Control) | 0x602 | 1 | OUT | 100 |
| [CCS_Extra_Information](#CCS_Extra_Information) | 0x603 | 6 | OUT | 100 |
| [ADM_CS_EVCC_Inputs](#ADM_CS_EVCC_Inputs) | 0x604 | 6 | OUT | 1000 |
| [EV_Information](#EV_Information) | 0x610 | 1 | IN | 100 |
| [AC_Status](#AC_Status) | 0x611 | 1 | IN | 100 |
| [DC_Status1](#DC_Status1) | 0x612 | 4 | IN | 100 |
| [DC_Status2](#DC_Status2) | 0x613 | 5 | IN | 100 |

</div>


## EVSE_Information

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x600 |
| **Length [Bytes]** | 6 |
| **Periodicity [ms]** | 100 |
| **Direction** | OUT |

</div>

### Description

Information about the EVSE (AC or DC source), when available.


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Communication_Stage | 8 | Label set |
| Protocol | 8 | Label set |
| Pins | 8 | Label set |
| Max_Current | 16 | Signed |
| RCD_Status | 1 | Single bit |
| Reserved_Flags | 7 | Unsigned |

</div>


### Payload description

#### Communication_Stage :id=EVSE_Information-Communication_Stage


Current internal state of the charge controller, reflecting communication stage.

> [!DLIST|label:Initialising]
> Controller's applications are starting up.

> [!DLIST|label:Waiting_For_EVSE]
> Controller is idle and ready for a plug-in.

> [!DLIST|label:Negotiating_Connection]
> Controller is plugged to a charger and the connection is
> being initialised. Important charge information are exchanged.

> [!DLIST|label:Connected_With_Full_Info]
> All charge information from the EVSE were retrieved
> and a charge session can be considered to be properly started.

> [!DLIST|label:Insulation_Test]
> Insulation of charge cable is being tested by charger.

> [!DLIST|label:Precharge]
> Charger is matching its output voltage to present voltage of the
> battery.

> [!DLIST|label:Waiting_For_Charge]
> PEV is about to begin the actual charge.

> [!DLIST|label:Charging]
> Main charging loop going on.

> [!DLIST|label:Ending_Charge]
> A normal charge stop condition happened and the PEV is exiting
> the charging loop.

> [!DLIST|label:Welding_Detection]
> PEV is testing if its contactors are welded.

> [!DLIST|label:Closing_Communication]
> PEV can unplug and we are reinitialising in order to
> then go back to *Waiting_For_EVSE*.




<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | 8 | Label set |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Initialising | 0 |
| Waiting_For_EVSE | 1 |
| Negotiating_Connection | 2 |
| Connected_With_Full_Info | 3 |
| Insulation_Test | 4 |
| Precharge | 5 |
| Waiting_For_Charge | 6 |
| Charging | 7 |
| Ending_Charge | 8 |
| Welding_Detection | 9 |
| Closing_Communication | 10 |

</div>

#### Protocol :id=EVSE_Information-Protocol

The charging protocol EVSE is using.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 8 | 8 | Label set |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
|  | 0 |
| CCS_PWM | 1 |
| CCS_DIN_70121_2012_v2 | 2 |
| CCS_ISO_15118_2013_v2 | 3 |
| CCS_ISO_15118_2022 | 4 |

</div>

#### Pins :id=EVSE_Information-Pins

Pins on which current is supplied. *CCS_AC* corresponds to any AC pins.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 16 | 8 | Label set |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
|  | 0 |
| CCS_AC | 1 |
| CCS_AC_Single_Phase_Core | 2 |
| CCS_AC_Three_Phase_Core | 3 |
| CCS_DC_Core | 4 |
| CCS_DC_Extended | 5 |

</div>

#### Max_Current :id=EVSE_Information-Max_Current


Maximum current the on-board charger (AC) or BMS (DC) is allowed to draw.

In AC, it is defined as the minimum between EVSE max current
(ie. CP PWM duty cycle) and cable max current (ie. PP resistance).

In DC it corresponds to HLC data.



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 24 | 16 | Signed | Amps | 0.1 | 0 | -3276 | 3276 |

</div>

#### RCD_Status :id=EVSE_Information-RCD_Status


Status of EVSE Residual Current Device (only available in HLC mode, 0 otherwise).
For information only.



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 40 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| No_Error | 0 |
| Error | 1 |

</div>

#### Reserved_Flags :id=EVSE_Information-Reserved_Flags

Reserved bits for future uses.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 41 | 7 | Unsigned |   | 1 | 0 |   |   |

</div>




## AC_Control

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x601 |
| **Length [Bytes]** | 1 |
| **Periodicity [ms]** | 100 |
| **Direction** | OUT |

</div>

### Description

AC charging specific control (from charge controller to on-board charger).


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Ready_To_Deliver_Power | 1 | Single bit |
| Reserved_Flags | 7 | Unsigned |

</div>


### Payload description

#### Ready_To_Deliver_Power :id=AC_Control-Ready_To_Deliver_Power


EVSE is in position of delivering power.

> [!WARNING]
> Does not mean that power is currently being delivered!


When going to *Ready*, the on-board charger should set its
[Ready_To_Charge](#AC_Status-Ready_To_Charge) flag, and THEN start to draw current.

When going to *Not_Ready* it means the AC source request a normal stop.
On-board charger should stop drawing current and THEN set its
[Ready_To_Charge](#AC_Status-Ready_To_Charge) flag to 0.



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Not_Ready | 0 |
| Ready | 1 |

</div>

#### Reserved_Flags :id=AC_Control-Reserved_Flags

Reserved bits for future uses.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 1 | 7 | Unsigned |   | 1 | 0 |   |   |

</div>




## DC_Control

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x602 |
| **Length [Bytes]** | 1 |
| **Periodicity [ms]** | 100 |
| **Direction** | OUT |

</div>

### Description

DC charging specific control (from charge controller to BMS).


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Close_Contactors | 1 | Single bit |
| Reserved_Flags | 7 | Unsigned |

</div>


### Payload description

#### Close_Contactors :id=DC_Control-Close_Contactors


Request for closing contactors. Close contactors when 1. Open them when 0.
If the message does not come after 1s timeout, consider it to be an emergency
situation and open contactors.

Alternatively, ADM-CS-EVCC unit has DC contactor drivers. To use them directly
instead of this CAN signal, enable them in the `/srv/config.cfg` file:

    [vehicle]
    dc_contactors_use_ios = true



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Open | 0 |
| Close | 1 |

</div>

#### Reserved_Flags :id=DC_Control-Reserved_Flags

Reserved bits for future uses.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 1 | 7 | Unsigned |   | 1 | 0 |   |   |

</div>




## CCS_Extra_Information

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x603 |
| **Length [Bytes]** | 6 |
| **Periodicity [ms]** | 100 |
| **Direction** | OUT |

</div>

### Description

Extra information from CCS (for information only).


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| CP_Duty_Cycle | 16 | Unsigned |
| CP_Top_Voltage | 8 | Unsigned |
| CP_State | 8 | Label set |
| PP_Resistance | 8 | Unsigned |
| Inlet_Lock_State | 2 | Label set |
| Reserved_Flags | 6 | Unsigned |

</div>


### Payload description

#### CP_Duty_Cycle :id=CCS_Extra_Information-CP_Duty_Cycle

Measured PWM duty cycle on the CP line.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | 16 | Unsigned | % | 0.1 | 0 | 0 | 100 |

</div>

#### CP_Top_Voltage :id=CCS_Extra_Information-CP_Top_Voltage

Measured PWM top voltage on the CP line.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 16 | 8 | Unsigned | Volts | 0.1 | 0 | 0 | 25 |

</div>

#### CP_State :id=CCS_Extra_Information-CP_State

Measured CP state.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 24 | 8 | Label set |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| E_or_F | 0 |
| D | 3 |
| C | 6 |
| B | 9 |
| A | 12 |

</div>

#### PP_Resistance :id=CCS_Extra_Information-PP_Resistance

Measured resistance from PP. 2550 Ohms means disconnected.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 32 | 8 | Unsigned | Ohms | 10 | 0 | 0 | 2550 |

</div>

#### Inlet_Lock_State :id=CCS_Extra_Information-Inlet_Lock_State

CCS Inlet lock state.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 40 | 2 | Label set |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Unlocked | 0 |
| Locked | 1 |
| Fault | 2 |

</div>

#### Reserved_Flags :id=CCS_Extra_Information-Reserved_Flags

Reserved bits for future uses.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 42 | 6 | Unsigned |   | 1 | 0 |   |   |

</div>




## ADM_CS_EVCC_Inputs

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x604 |
| **Length [Bytes]** | 6 |
| **Periodicity [ms]** | 1000 |
| **Direction** | OUT |

</div>

### Description


Controller (ADM-CS-EVCC hardware variant) is reporting various information
about its inputs. It is sent every seconds (for temperature channels).
Or on change for other digital inputs.



### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| DC_Contactor_Positive_Feedback | 1 | Single bit |
| DC_Contactor_Negative_Feedback | 1 | Single bit |
| Digital_Input1 | 1 | Single bit |
| Digital_Input2 | 1 | Single bit |
| Stop_Charge | 1 | Single bit |
| Reserved_Flags | 3 | Unsigned |
| PTC0 | 8 | Unsigned |
| PTC1 | 8 | Unsigned |
| PTC2 | 8 | Unsigned |
| CPU_Temperature | 8 | Unsigned |
| CAN_Sensor_Temperature | 8 | Unsigned |

</div>


### Payload description

#### DC_Contactor_Positive_Feedback :id=ADM_CS_EVCC_Inputs-DC_Contactor_Positive_Feedback

Reports the logical state of R-2E.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Open | 0 |
| Close | 1 |

</div>

#### DC_Contactor_Negative_Feedback :id=ADM_CS_EVCC_Inputs-DC_Contactor_Negative_Feedback

Reports the logical state of R-2F.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 1 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Open | 0 |
| Close | 1 |

</div>

#### Digital_Input1 :id=ADM_CS_EVCC_Inputs-Digital_Input1


Reports the logical state of R-1G.
Needs to be declared as monitored in `/srv/config.cfg`:

    [hardware]
    dig_in1 = Monitor



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 2 | Single bit | Single bit |   | 1 | 0 | 0 | 1 |

</div>

#### Digital_Input2 :id=ADM_CS_EVCC_Inputs-Digital_Input2


Reports the logical state of R-2G.
Needs to be declared as monitored in `/srv/config.cfg`:

    [hardware]
    dig_in2 = Monitor



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 3 | Single bit | Single bit |   | 1 | 0 | 0 | 1 |

</div>

#### Stop_Charge :id=ADM_CS_EVCC_Inputs-Stop_Charge


Reports the logical state of R-3F (or any other input declared as Stop function).



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 4 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| No_Request | 0 |
| Stop_Requested | 1 |

</div>

#### Reserved_Flags :id=ADM_CS_EVCC_Inputs-Reserved_Flags

Reserved bits for future uses.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 5 | 3 | Unsigned |   | 1 | 0 |   |   |

</div>

#### PTC0 :id=ADM_CS_EVCC_Inputs-PTC0

Measured temperature sensor on L-2D.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 8 | 8 | Unsigned | °C | 1 | -40 | -40 | 215 |

</div>

#### PTC1 :id=ADM_CS_EVCC_Inputs-PTC1

Measured temperature sensor on L-1E.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 16 | 8 | Unsigned | °C | 1 | -40 | -40 | 215 |

</div>

#### PTC2 :id=ADM_CS_EVCC_Inputs-PTC2

Measured temperature sensor on L-3E.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 24 | 8 | Unsigned | °C | 1 | -40 | -40 | 215 |

</div>

#### CPU_Temperature :id=ADM_CS_EVCC_Inputs-CPU_Temperature

Temperature reported by the CPU chip of the charge controller.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 32 | 8 | Unsigned | °C | 1 | -40 | -40 | 215 |

</div>

#### CAN_Sensor_Temperature :id=ADM_CS_EVCC_Inputs-CAN_Sensor_Temperature

If using a CAN sensor, and it has a temperature channel.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 40 | 8 | Unsigned | °C | 1 | -40 | -40 | 215 |

</div>


## EV_Information

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x610 |
| **Length [Bytes]** | 3 |
| **Periodicity [ms]** | 100 |
| **Direction** | IN |

</div>

### Description

Information provided by the vehicle.


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| State_of_Charge | 8 | Unsigned |
| Energy_Capacity | 16 | Unsigned |

</div>


### Payload description

#### State_of_Charge :id=EV_Information-State_of_Charge

Battery SoC in percent (only used in HLC mode).


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | 8 | Unsigned | % | 1 | 0 | 0 | 100 |

</div>

#### Energy_Capacity :id=EV_Information-Energy_Capacity

The energy capacity of the EV battery.
In case this value is 0 we default to the config file entry `energy_capacity`.

Pleaase note that providing the energy capacity of the battery is mandatory if ISO15118-20 is used.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 8 | 16 | Unsigned | kWh | 0.01 | 0 | 0 | 655 |

</div>


## AC_Status

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x611 |
| **Length [Bytes]** | 1 |
| **Periodicity [ms]** | 100 |
| **Direction** | IN |

</div>

### Description

AC charging specific status (from on-board charger to charge controller).


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Ready_To_Charge | 1 | Single bit |
| Reserved_Flags | 7 | Unsigned |

</div>


### Payload description

#### Ready_To_Charge :id=AC_Status-Ready_To_Charge


On-board charger is ready to charge (corresponds to asserting CP state C/D).
You should set it to 1 before starting to draw current.
And set it to 0 after current draw stops.

Only exception is in case of emergency stop, where you can set it to 0 without
waiting for the current draw to stop beforehand.



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Not_Ready | 0 |
| Ready | 1 |

</div>

#### Reserved_Flags :id=AC_Status-Reserved_Flags

Reserved bits for future uses.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 1 | 7 | Unsigned |   | 1 | 0 |   |   |

</div>




## DC_Status1

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x612 |
| **Length [Bytes]** | 8 |
| **Periodicity [ms]** | 100 |
| **Direction** | IN |

</div>

### Description

DC charging specific status (from BMS to charge controller), message 1.


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Max_Charge_Current | 16 | Signed |
| Present_Current | 16 | Signed |
| Max_Discharge_Current | 16 | Unsigned |


</div>


### Payload description

#### Max_Charge_Current :id=DC_Status1-Max_Charge_Current

Used as the target current sent to EVSE except for power transfer
This signal can be used to dynamically update the EV Maximum charge current
when the config entry "use_dynamic_current_limits" is set to true
Otherwise the static configured "max_current" is used.

    [vehicle]
    use_dynamic_current_limits = true

Will be capped by maximum current from config file and from EVSE data.

When in <<No BMS mode>>, the target current will be set to the config file
entry "max_current". When doing so, you should set a safe `max_charge_voltage` to terminate the
charge earlier than at full pack (ie. bulk charging):

    [vehicle]
    no_bms = true
    max_current = 20
    max_charge_voltage = 380
    target_voltage = 410
    max_voltage = 450

In no BMS mode, this signal will be ignored.

> [!NOTE]
> Signal is of signed data type for compatibility with bidirectional
> implementations.

<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | 16 | Signed | Amps | 0.1 | 0 | -3276 | 3276 |

</div>

#### Present_Current :id=DC_Status1-Present_Current

Measurement of current flowing in or out of the battery.

Alternatively, this information can be obtained by using a supported CAN sensor.
Declare it as such in `/srv/config.cfg`:

    [vehicle]
    use_can_sensor = Isabellenhutte IVT-S

In such case, this signal will be ignored.
Refer to [CAN sensor](charge-controllers/evcc_configuration/can_sensor.md) documentation to know how the sensor should be wired.

> [!NOTE]
> Signal is of signed data type for compatibility with future bidirectional
> implementations.

<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 16 | 16 | Signed | Amps | 0.1 | 0 | -3276 | 3276 |

</div>

#### Max_Discharge_Current :id=DC_Status1-Max_Discharge_Current

Only taken into account in CCS ISO15118-20 Dynamic mode.
This signal can be used to dynamically update the EV Maximum Discharge current
when the config entry "use_dynamic_current_limits" is set to true
Otherwise the static configured "max_discharge_current" is used.

    [vehicle]
    use_dynamic_current_limits = true

Note that negative values will be disregarded.
Will be capped by max_discharge_current from config file.

<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 32 | 16 | Unsigned | Amps | 0.1 | 0 | 0 | 6553 |

</div>

## DC_Status2

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x613 |
| **Length [Bytes]** | 5 |
| **Periodicity [ms]** | 100 |
| **Direction** | IN |

</div>

### Description

DC charging specific status (from BMS to charge controller), message 2.


### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Contactors_Closed | 1 | Single bit |
| Normal_End_of_Charge | 1 | Single bit |
| Emergency_Stop | 1 | Single bit |
| Reserved_Flags | 6 | Unsigned |
| Battery_Voltage | 16 | Unsigned |
| Inlet_Voltage | 16 | Unsigned |

</div>


### Payload description

#### Contactors_Closed :id=DC_Status2-Contactors_Closed


Report states of contactors.

Alternatively, ADM-CS-EVCC unit has DC contactors feedback inputs.
To use them directly instead of this CAN signal, enable them in
the `/srv/config.cfg` file:

    [vehicle]
    dc_contactors_use_ios = true



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| Open | 0 |
| Close | 1 |

</div>

#### Normal_End_of_Charge :id=DC_Status2-Normal_End_of_Charge


Vehicle request a normal charge termination
(user request, or soft battery voltage limit reached (eg. bulk charging)).

Only acts on change (so you need to cycle it back to 0).

Alternatively, you can also use the 12V input (R-3F) on ADM-CS-EVCC unit.



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 1 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| No_Request | 0 |
| Stop_Requested | 1 |

</div>

#### Emergency_Stop :id=DC_Status2-Emergency_Stop


Vehicle request an emergency charge termination Only acts on change (so you need to cycle it back to 0).

<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 2 | Single bit | Single bit |   | 1 | 0 |   |   |

</div>


<div class="small-table compact-table">

| Label name | Value |
|------------|-------|
| No_Request | 0 |
| Emergency_Stop_Requested | 1 |

</div>

#### Reserved_Flags :id=DC_Status2-Reserved_Flags

Reserved bits for future uses.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 2 | 6 | Unsigned |   | 1 | 0 |   |   |

</div>

#### Battery_Voltage :id=DC_Status2-Battery_Voltage


Measurement of battery pack voltage.

Alternatively, this information can be obtained by using a supported CAN sensor.
Declare it as such in `/srv/config.cfg`:

    [vehicle]
    use_can_sensor = Isabellenhutte IVT-S

In such case, this signal will be ignored.
Refer to [CAN sensor](charge-controllers/evcc_configuration/can_sensor.md) documentation to know how the sensor should be wired.



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 8 | 16 | Unsigned | Volts | 0.1 | 0 | 0 | 6553 |

</div>

#### Inlet_Voltage :id=DC_Status2-Inlet_Voltage


Measurement of inlet voltage (ie. before contactors).

Alternatively, this information can be obtained by using a supported CAN sensor.
Declare it as such in `/srv/config.cfg`:

    [vehicle]
    use_can_sensor = Isabellenhutte IVT-S

In such case, this signal will be ignored.
Refer to [CAN sensor](charge-controllers/evcc_configuration/can_sensor.md) documentation to know how the sensor should be wired.



<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 24 | 16 | Unsigned | Volts | 0.1 | 0 | 0 | 6553 |

</div>


## EV_Energy_Request

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x614 |
| **Length [Bytes]** | 6 |
| **Periodicity [ms]** | 100 |
| **Direction** | IN |

</div>

### Description

ISO 15118-20 specific message.
The energy of the EV corresponding to the SOC specified by the owner.
The energy request is represented by an energy range including a target energy request.

Energy requests should satisfy the following relationship:
```
Minimum_Energy_Request ≤ Target_Energy_Request ≤ Maximum_Energy_Request
```

### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Target_Energy_Request | 16 | Unsigned |
| Minimum_Energy_Request | 16 | Unsigned |
| Maximum_Energy_Request | 16 | Unsigned |

</div>


### Payload description

#### Target_Energy_Request :id=EV_Energy_Request-Target_Energy_Request

The energy of the EV corresponding to the target SOC.
The target energy request can be lower than the current energy level present in the battery represented by the SoC.
This represents a discharge request. More details available in the ISO15118-20 documentation.

<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | 16 | Unsigned | kWh | 0.01 | 0 | 0 | 655 |

</div>

#### Minimum_Energy_Request :id=EV_Energy_Request-Minimum_Energy_Request

The energy of the EV corresponding to the minimum SOC.
In case this message is not sent we default to the config file entry `min_energy_request`.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 16 | 16 | Unsigned | kWh | 0.01 | 0 | 0 | 655 |

</div>

#### Maximum_Energy_Request :id=EV_Energy_Request-Maximum_Energy_Request

The energy of the EV corresponding the to maximum SOC.
In case this message is not sent we default to the config file entry `max_energy_request`.
This value will be capped by Energy_Capacity.


<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 16 | 16 | Unsigned | kWh | 0.01 | 0 | 0 | 655 |

</div>

## EV_V2X_Energy_Request

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x615 |
| **Length [Bytes]** | 4 |
| **Periodicity [ms]** | 100 |
| **Direction** | IN |

</div>

### Description

ISO 15118-20 specific message. (Optional)
Indicates a preferred operational V2X energy range for bidirectional cycling.
V2X energy requests should satisfy the following relationships:
```
Minimum_Energy_Request ≤ Minimum_V2X_Energy_Request
Maximum_V2X_Energy_Request ≤ Maximum_Energy_Request
```

### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Minimum_V2X_Energy_Request | 16 | Unsigned |
| Maximum_V2X_Energy_Request | 16 | Unsigned |

</div>


### Payload description

#### Minimum_V2X_Energy_Request :id=EV_Energy_Request-Minimum_V2X_Energy_Request

The minimum energy level for the bidirectional cycling activity range.

<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | 16 | Unsigned | kWh | 0.01 | 0 | 0 | 655 |

</div>

#### Maximum_Energy_Request :id=EV_Energy_Request-Maximum_Energy_Request

The maximum energy level for the bidirectional cycling activity range.

<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 16 | 16 | Unsigned | kWh | 0.01 | 0 | 0 | 655 |

</div>

## EV_Extra_BPT_Information

<div class="noheader-table small-table compact-table">

| * | * |
|---|---|
| **Frame ID** | 0x616 |
| **Length [Bytes]** | 4 |
| **Periodicity [ms]** | 100 |
| **Direction** | IN |

</div>

### Description

ISO 15118-20 specific message.
EV extra bidirectional power transfer information.
### Payload


<div class="small-table compact-table">

| Signal | Length (bits) | Type |
|--------|---------------|------|
| Departure_Time | 32 | Unsigned |

</div>


### Payload description

#### Departure_Time :id=EV_Extra_BPT_Information-Departure_Time

Indicate when the EV intends to finish the charging process.
Represents the offset in seconds from the point in time of sending this message.
<div class="small-table compact-table">

| Start bit | Length (bits) | Type | Unit | Scale | Offset | Min | Max |
|-----------|---------------|------|------|-------|--------|-----|-----|
| 0 | 32 | Unsigned | Seconds | 1 | 0 | 0 | 4294967296 |

</div>

